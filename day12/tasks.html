<!DOCTYPE html>
<html>
<head>
<title>JSON & Fetch – 35 Tasks</title>
<style>
 body { font-family: Arial; line-height:1.6 }
 h2 { color: darkblue }
 .box { background:#f2f2f2; padding:10px }
  #gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
    }
    #gallery img {
        width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 8px;
    }
       .post-item { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
    .pagination { display: flex; gap: 5px; flex-wrap: wrap; margin-top: 20px; }
    .pagination button { padding: 6px 10px; cursor: pointer; border: 1px solid #333; border-radius: 4px; background-color: #f0f0f0; }
    .pagination button.active { background-color: #333; color: white; }

    .comment { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
    .comment h4 { margin: 0 0 5px 0; }
    button { padding: 6px 12px; cursor: pointer; margin-bottom: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    select, button { padding: 6px 12px; margin-right: 10px; }
    input { padding: 8px; width: 250px; }
    button { padding: 8px 12px; }
    .meal { margin: 10px 0; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
    .error { color: red; }
        select {
      padding: 8px;
      width: 250px;
    }
     /* Loader */
    .loader {
      width: 40px;
      height: 40px;
      border: 5px solid #ddd;
      border-top: 5px solid #000;
      border-radius: 50%;
      animation: rotate 1s linear infinite;
      display: none;
      margin: 20px auto;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .card {
      border-bottom: 1px solid #ccc;
      padding: 8px 0;
    }
</style>
</head>
<body>

<h1>JSON & Fetch API – 35 Tasks</h1>

<!-- 1 -->
<h2>1. Object → JSON</h2>
<p>Value: {name:"Banu", age:30}</p>
<div class="box" id="t1"></div><hr>
<script>
document.getElementById("t1").innerHTML =
JSON.stringify({name:"Banu",age:30});
</script>

<!-- 2 -->
<h2>2. JSON → Object</h2>
<p>Value: {"city":"Chennai","pin":600001}</p>
<div class="box" id="t2"></div><hr>
<script>
let o2 = JSON.parse('{"city":"Chennai","pin":600001}');
t2.innerHTML = o2.city + " - " + o2.pin;
</script>

<!-- 3 -->
<h2>3. Fetch JSON File</h2>
<p>File: data.json</p>
<div class="box" id="t3">Loading...</div><hr>
<script>
fetch("data.json").then(r=>r.json()).then(d=>{
 t3.innerHTML=d.map(i=>`${i.name} - ₹${i.price}`).join("<br>");
});
</script>

<!-- 4 -->
<h2>4. Store Array in LocalStorage</h2>
<p>Value: [{id:1,name:"A"},{id:2,name:"B"}]</p>
<div class="box" id="t4"></div><hr>
<script>
localStorage.setItem("arr4",JSON.stringify([{id:1,name:"A"},{id:2,name:"B"}]));
t4.innerHTML=JSON.parse(localStorage.getItem("arr4")).map(i=>i.name);
</script>

<!-- 5 -->
<h2>5. API Data in Table</h2>
<div class="box" id="t5">Loading...</div><hr>
<script>
fetch("https://jsonplaceholder.typicode.com/users")
.then(r=>r.json()).then(d=>{
 t5.innerHTML="<table border=1><tr><th>Name</th><th>Email</th></tr>"+
 d.slice(0,3).map(u=>`<tr><td>${u.name}</td><td>${u.email}</td></tr>`).join("")+
 "</table>";
});
</script>

<!-- 6 -->
<h2>6. Modify JSON Object</h2>
<div class="box" id="t6"></div><hr>
<script>
let a6=[{id:1,name:"Pen"},{id:2,name:"Book"}];
a6[1].name="Notebook";
t6.innerHTML=JSON.stringify(a6);
</script>

<!-- 7 -->
<h2>7. Filter JSON</h2>
<div class="box" id="t7"></div><hr>
<script>
t7.innerHTML=JSON.stringify(a6.filter(i=>i.id===1));
</script>

<!-- 8 -->
<h2>8. Sort JSON</h2>
<div class="box" id="t8"></div><hr>
<script>
let a8=[{p:30},{p:10},{p:50}];
a8.sort((a,b)=>a.p-b.p);
t8.innerHTML=JSON.stringify(a8);
</script>

<!-- 9 -->
<h2>9. Find Object</h2>
<div class="box" id="t9"></div><hr>
<script>
t9.innerHTML=JSON.stringify(a8.find(i=>i.p===30));
</script>

<!-- 10 -->
<h2>10. Add Object</h2>
<div class="box" id="t10"></div><hr>
<script>
a8.push({p:99});
t10.innerHTML=JSON.stringify(a8);
</script>

<!-- 11 -->
<h2>11. Remove Object</h2>
<div class="box" id="t11"></div><hr>
<script>
t11.innerHTML=JSON.stringify(a8.filter(i=>i.p!==10));
</script>

<!-- 12 -->
<h2>12. Dropdown from JSON</h2>
<select id="t12"></select><hr>
<script>
fetch("data.json").then(r=>r.json()).then(d=>{
 d.forEach(i=>t12.innerHTML+=`<option>${i.name}</option>`);
});
</script>

<!-- 13 -->
<h2>13. Fetch data from an API and handle errors using .catch()</h2>

<p><b>API Used:</b> Invalid URL (to demonstrate error handling)</p>

<div class="box" id="t13">Loading data...</div>
<hr>

<script>
fetch("https://invalid-api-url-example.com/data")
.then(response => {
  if (!response.ok) {
    throw new Error("Network response was not ok");
  }
  return response.json();
})
.then(data => {
  document.getElementById("t13").innerHTML =
    "Data fetched successfully";
})
.catch(error => {
  document.getElementById("t13").innerHTML =
    "Error occurred while fetching data";
});
</script>


<!-- 14 -->
<h2>14. Nested Object → JSON</h2>
  <!-- <h2>Nested JavaScript Object to JSON String</h2> -->
  <button id="convertBtn">Convert Object to JSON</button>
  <pre id="output14"></pre>

  <script>
    // Nested JavaScript object
    const nestedObject = {
      name: "Banu",
      age: 30,
      address: {
        street: "123 Main St",
        city: "Chennai",
        state: "Tamil Nadu"
      },
      hobbies: ["reading", "coding", "badminton"]
    };

    // Select button and output area
    const button = document.getElementById("convertBtn");
    const output14 = document.getElementById("output14");

    // Event listener for button click
    button.addEventListener("click", () => {
      // Convert nested object to JSON string
      const jsonString = JSON.stringify(nestedObject, null, 2); // 'null, 2' for pretty print
      // Display JSON string in the <pre> tag
      output14.textContent = jsonString;
    });
  </script>

<!-- 15 -->
<h2>15. Parse JSON Array</h2>
<!-- <h2>Users Output</h2> -->
  <div id="outputArea"></div>

  <script>
    // JSON string (array of objects)
    const jsonString = `
    [
      { "id": 1, "name": "Banu", "role": "Admin" },
      { "id": 2, "name": "Priya", "role": "User" },
      { "id": 3, "name": "Kavi", "role": "Moderator" }
    ]
    `;

    // Parse JSON string
    const dataArray = JSON.parse(jsonString);

    const outputArea = document.getElementById("outputArea");

    // Display each object in browser
    dataArray.forEach(item => {
      const div = document.createElement("div");
      div.className = "box";
      div.innerHTML = `
        <p><b>ID:</b> ${item.id}</p>
        <p><b>Name:</b> ${item.name}</p>
        <p><b>Role:</b> ${item.role}</p>
      `;
      outputArea.appendChild(div);
    });
  </script>

<!-- 16 -->
  <h2>16.Users by Role</h2>

  <select id="roleSelect" onchange="loadUsersByRole()">
    <option value="admin">Admin</option>
    <option value="user">User</option>
    <option value="moderator">Moderator</option>
  </select>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Role</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>
    async function loadUsersByRole() {
      const selectedRole = document.getElementById("roleSelect").value;
      const tableBody = document.getElementById("tableBody");

      tableBody.innerHTML = "<tr><td colspan='3'>Loading...</td></tr>";

      try {
        const apiResponse = await fetch("https://dummyjson.com/users");

        if (!apiResponse.ok) {
          throw new Error("API failed");
        }

        const resultData = await apiResponse.json();

        // Filter users by role
        const filteredList = resultData.users.filter(
          person => person.role === selectedRole
        );

        tableBody.innerHTML = "";

        if (filteredList.length === 0) {
          tableBody.innerHTML =
            "<tr><td colspan='3'>No users found</td></tr>";
          return;
        }

        filteredList.forEach(person => {
          const row = `
            <tr>
              <td>${person.firstName} ${person.lastName}</td>
              <td>${person.email}</td>
              <td>${person.role}</td>
            </tr>
          `;
          tableBody.innerHTML += row;
        });

      } catch (error) {
        console.error(error);
        tableBody.innerHTML =
          "<tr><td colspan='3'>Error loading users</td></tr>";
      }
    }

    // Load default role on page load
    loadUsersByRole();
  </script>

<!-- 17 -->
  <h2>17.User Info</h2>

  <button onclick="saveUserData()">Save Data</button>
  <button onclick="loadUserData()">Load Data</button>

  <div id="displayBox"></div>

  <script>
    function saveUserData() {
      const userDetails = {
        name: "Banu",
        email: "banu@example.com",
        role: "Developer"
      };

      // Convert object to JSON string and store
      localStorage.setItem("userInfo", JSON.stringify(userDetails));
      alert("Data saved in LocalStorage!");
    }

    function loadUserData() {
      const displayBox = document.getElementById("displayBox");

      // Get JSON string from LocalStorage
      const storedData = localStorage.getItem("userInfo");

      if (!storedData) {
        displayBox.textContent = "No data found.";
        return;
      }

      // Convert JSON string back to object
      const parsedData = JSON.parse(storedData);

      displayBox.innerHTML = `
        <p><b>Name:</b> ${parsedData.name}</p>
        <p><b>Email:</b> ${parsedData.email}</p>
        <p><b>Role:</b> ${parsedData.role}</p>
      `;
    }

    // Auto load data after page refresh
    window.onload = loadUserData;
  </script>

<!-- 18 -->
<h2>18. Fetch data using async/await</h2>

<!-- <p><b>API Used:</b> Random User API</p> -->

<div class="box" id="t18">Loading user data...</div>
<hr>

<script>
async function fetchUser() {
  try {
    const response = await fetch("https://randomuser.me/api/");
    const data = await response.json();

    const user = data.results[0];

    document.getElementById("t18").innerHTML =
      "Name: " + user.name.first + " " + user.name.last + "<br>" +
      "Gender: " + user.gender + "<br>" +
      "Email: " + user.email + "<br>" +
      "Country: " + user.location.country;
  } catch (error) {
    document.getElementById("t18").innerHTML =
      "Failed to fetch user data";
  }
}

fetchUser();
</script>


<!-- 19 -->
<h2>19. Fetch weather data for multiple cities</h2>

<!-- <p><b>API:</b> Open-Meteo (Free API)</p> -->
<p><b>Cities:</b> Chennai, Delhi, Mumbai</p>

<script>
// Create output containers first
document.write("<div id='chennai'></div>");
document.write("<div id='delhi'></div>");
document.write("<div id='mumbai'></div>");
</script>

<hr>

<script>
const cities = [
  { id: "chennai", name: "Chennai", lat: 13.08, lon: 80.27 },
  { id: "delhi", name: "Delhi", lat: 28.61, lon: 77.20 },
  { id: "mumbai", name: "Mumbai", lat: 19.07, lon: 72.87 }
];

cities.forEach(city => {
  fetch(`https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current_weather=true`)
    .then(res => res.json())
    .then(data => {
      document.getElementById(city.id).innerHTML =
        "<div style='border:1px solid black;padding:10px;margin:10px;width:250px'>" +
        "<h3>" + city.name + "</h3>" +
        "Temperature: " + data.current_weather.temperature + " °C<br>" +
        "Wind Speed: " + data.current_weather.windspeed + " km/h" +
        "</div>";
    })
    .catch(() => {
      document.getElementById(city.id).innerHTML =
        "Error loading weather data";
    });
});
</script>


<!-- 20 -->
<h2>20. Pagination using Fetch API</h2>

<p><b>API Used:</b> JSONPlaceholder Posts</p>
<p><b>Items per page:</b> 10</p>

<script>
// create output area using document.write
document.write("<div id='posts'></div>");
document.write("<button onclick='prevPage()'>Previous</button> ");
document.write("<button onclick='nextPage()'>Next</button>");
</script>

<hr>

<script>
let page = 1;
const limit = 10;

function loadPosts() {
  fetch(`https://jsonplaceholder.typicode.com/posts?_page=${page}&_limit=${limit}`)
    .then(res => res.json())
    .then(data => {
      let output = "<h3>Page " + page + "</h3>";
      data.forEach(post => {
        output +=
          "Post ID: " + post.id + "<br>" +
          "Title: " + post.title + "<br><br>";
      });
      document.getElementById("posts").innerHTML = output;
    })
    .catch(() => {
      document.getElementById("posts").innerHTML =
        "Error loading posts";
    });
}

function nextPage() {
  page++;
  loadPosts();
}

function prevPage() {
  if (page > 1) {
    page--;
    loadPosts();
  }
}

// initial load
loadPosts();
</script>


<!-- 21 -->
<h2>21. Fetch a random joke from an API</h2>

<p><b>API Used:</b> Official Joke API</p>

<script>
// create output container using document.write
document.write("<div id='jokeBox' style='border:1px solid black;padding:10px;width:400px'></div>");
</script>

<hr>

<script>
fetch("https://official-joke-api.appspot.com/random_joke")
  .then(response => response.json())
  .then(data => {
    document.getElementById("jokeBox").innerHTML =
      "<b>Joke Type:</b> " + data.type + "<br><br>" +
      "<b>Question:</b> " + data.setup + "<br>" +
      "<b>Answer:</b> " + data.punchline;
  })
  .catch(() => {
    document.getElementById("jokeBox").innerHTML =
      "Failed to load joke";
  });
</script>


<!-- 22 -->
<h2>22. Fetch posts from an API and display them in a list</h2>

<p><b>API Used:</b> JSONPlaceholder Posts</p>
<p><b>Data:</b> Post ID and Title</p>

<script>
// create output container using document.write
document.write("<ul id='postList'></ul>");
</script>

<hr>

<script>
fetch("https://jsonplaceholder.typicode.com/posts?_limit=5")
  .then(response => response.json())
  .then(data => {
    let listItems = "";
    data.forEach(post => {
      listItems +=
        "<li>" +
        "Post ID: " + post.id + "<br>" +
        "Title: " + post.title +
        "</li><br>";
    });
    document.getElementById("postList").innerHTML = listItems;
  })
  .catch(() => {
    document.getElementById("postList").innerHTML =
      "<li>Failed to load posts</li>";
  });
</script>


<!-- 23 -->
<h2>23. Submit a form using Fetch API</h2>

<p><b>API Used:</b> JSONPlaceholder Posts</p>
<p>Form submits <b>title</b> and <b>body</b> of a post</p>

<script>
// Create output container using document.write
document.write(`
<form id="postForm" style="margin-bottom:10px;">
  Title: <input type="text" id="title" value="Hello World"><br><br>
  Body: <input type="text" id="body" value="This is a test post"><br><br>
  <button type="submit">Submit</button>
</form>
<div id="postResult" style="border:1px solid black;padding:10px;width:400px"></div>
`);
</script>

<hr>

<script>
document.getElementById("postForm").addEventListener("submit", function(e){
  e.preventDefault(); // prevent page reload

  const postData = {
    title: document.getElementById("title").value,
    body: document.getElementById("body").value,
    userId: 1
  };

  fetch("https://jsonplaceholder.typicode.com/posts", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(postData)
  })
  .then(response => response.json())
  .then(data => {
    document.getElementById("postResult").innerHTML =
      "Post submitted successfully!<br>" +
      "Post ID: " + data.id + "<br>" +
      "Title: " + data.title + "<br>" +
      "Body: " + data.body;
  })
  .catch(() => {
    document.getElementById("postResult").innerHTML =
      "Failed to submit post";
  });
});
</script>


<!-- 24 -->
<h2>24. Fetch real-time weather data using a free API</h2>

<!-- <p><b>API Used:</b> Open-Meteo (No API Key)</p> -->
<p><b>City:</b> Chennai</p>

<div id="weather24" style="border:1px solid black;padding:10px;width:300px">Loading weather...</div>

<hr>

<script>
const city = { name: "Chennai", lat: 13.08, lon: 80.27 };

fetch(`https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current_weather=true`)
  .then(response => response.json())
  .then(data => {
    const weather = data.current_weather;
    document.getElementById("weather24").innerHTML =
      "City: " + city.name + "<br>" +
      "Temperature: " + weather.temperature + " °C<br>" +
      "Wind Speed: " + weather.windspeed + " km/h<br>" +
      "Weather Code: " + weather.weathercode;
  })
  .catch(() => {
    document.getElementById("weather24").innerHTML =
      "Failed to fetch weather data";
  });
</script>

<hr>

<!-- 25 -->
<h2>25.GitHub User Profile</h2>

<input type="text" id="username" placeholder="Enter GitHub username">
<button onclick="getProfile()">Fetch</button>

<div id="profile" style="margin-top:20px;"></div>
<script>
function getProfile() {
    const username = document.getElementById('username').value;
    if (!username) {
        alert("Enter a username");
        return;
    }

    fetch(`https://api.github.com/users/${username}`)
    .then(res => {
        if (!res.ok) throw new Error("User not found");
        return res.json();
    })
    .then(data => {
        document.getElementById('profile').innerHTML = `
            <img src="${data.avatar_url}" width="100" alt="Avatar"><br>
            <strong>Name:</strong> ${data.name || "N/A"}<br>
            <strong>Bio:</strong> ${data.bio || "N/A"}<br>
            <strong>Followers:</strong> ${data.followers} | 
            <strong>Following:</strong> ${data.following}<br>
            <strong>Repos:</strong> ${data.public_repos}<br>
            <a href="${data.html_url}" target="_blank">GitHub Profile</a>
        `;
    })
    .catch(err => {
        document.getElementById('profile').innerHTML = `<p style="color:red">${err.message}</p>`;
    });
}
</script>

<!-- 26 -->
<h2>26.Image Gallery</h2>
<button onclick="loadImages()">Load Images</button>

<div id="gallery"></div>

<script>
function loadImages() {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';

    // Generate 12 random images from Picsum Photos
    for (let i = 0; i < 12; i++) {
        const img = document.createElement('img');
        img.src = `https://picsum.photos/300/200?random=${Math.floor(Math.random() * 1000)}`;
        img.alt = "Random Image";
        gallery.appendChild(img);
    }
}
</script>

<!-- 27 -->
<h2>27. Pagination</h2>
<div id="postsContainer">Loading...</div>
<div class="pagination" id="paginationContainer"></div>

<script>
let pageNumber = 1;         // current page
const itemsPerPage = 10;    // number of posts per page
const totalPages = 10;      // total pages (JSONPlaceholder has 100 posts)

async function fetchPosts(page) {
    const postsContainer = document.getElementById('postsContainer');
    postsContainer.innerHTML = 'Loading...';

    try {
        const response = await fetch(`https://jsonplaceholder.typicode.com/posts?_page=${page}&_limit=${itemsPerPage}`);
        const posts = await response.json();

        postsContainer.innerHTML = '';
        posts.forEach(post => {
            const postDiv = document.createElement('div');
            postDiv.classList.add('post-item');
            postDiv.innerHTML = `<h3>${post.id}. ${post.title}</h3><p>${post.body}</p>`;
            postsContainer.appendChild(postDiv);
        });

        renderPaginationButtons();
    } catch (error) {
        postsContainer.innerHTML = 'Failed to load posts.';
        console.error(error);
    }
}

function renderPaginationButtons() {
    const paginationContainer = document.getElementById('paginationContainer');
    paginationContainer.innerHTML = '';

    for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement('button');
        button.textContent = i;
        if (i === pageNumber) button.classList.add('active');
        button.addEventListener('click', () => {
            pageNumber = i;
            fetchPosts(pageNumber);
        });
        paginationContainer.appendChild(button);
    }
}

// Load first page
fetchPosts(pageNumber);
</script>

<!-- 28 -->
<h2>28.Comments Section</h2>
<button onclick="loadComments()">Load Comments</button>
<div id="commentsContainer"></div>

<script>
function loadComments() {
    const xhr = new XMLHttpRequest();
    const commentsContainer = document.getElementById('commentsContainer');

    commentsContainer.innerHTML = "Loading comments...";

    xhr.open('GET', 'https://jsonplaceholder.typicode.com/comments?_limit=10', true);

    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) { // DONE
            if (xhr.status === 200) {
                const comments = JSON.parse(xhr.responseText);
                commentsContainer.innerHTML = '';

                comments.forEach(comment => {
                    const div = document.createElement('div');
                    div.classList.add('comment');
                    div.innerHTML = `<h4>${comment.name} (${comment.email})</h4><p>${comment.body}</p>`;
                    commentsContainer.appendChild(div);
                });
            } else {
                commentsContainer.innerHTML = 'Failed to load comments.';
            }
        }
    };

    xhr.send();
}
</script>

<!-- 29 -->
<h2>29.Currency Exchange Rates</h2>

<label for="baseCurrency">Base Currency:</label>
<select id="baseCurrency">
    <option value="USD">USD</option>
    <option value="EUR">EUR</option>
    <option value="GBP">GBP</option>
    <option value="INR">INR</option>
</select>

<button onclick="getRates()">Get Rates</button>

<table id="ratesTable">
    <thead>
        <tr>
            <th>Currency</th>
            <th>Rate</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
async function getRates() {
    const base = document.getElementById('baseCurrency').value;
    const tbody = document.querySelector('#ratesTable tbody');
    tbody.innerHTML = '<tr><td colspan="2">Loading...</td></tr>';

    try {
        const response = await fetch(`https://api.frankfurter.app/latest?from=${base}`);
        if (!response.ok) throw new Error("Network error");

        const data = await response.json();
        tbody.innerHTML = '';

        for (const [currency, rate] of Object.entries(data.rates)) {
            const row = document.createElement('tr');
            row.innerHTML = `<td>${currency}</td><td>${rate.toFixed(4)}</td>`;
            tbody.appendChild(row);
        }
    } catch (error) {
        console.error(error);
        tbody.innerHTML = '<tr><td colspan="2">Failed to fetch rates.</td></tr>';
    }
}
</script>


<!-- 30 -->
<h2>30.Load On Button Click</h2>
<button onclick="loadData()">Load Data</button>

<div id="dataContainer"></div>

<script>
async function loadData() {
    const container = document.getElementById('dataContainer');
    container.innerHTML = 'Loading...';

    try {
        const response = await fetch('https://jsonplaceholder.typicode.com/users');
        if (!response.ok) throw new Error('Failed to fetch data');

        const users = await response.json();
        container.innerHTML = '';

        users.forEach(user => {
            const div = document.createElement('div');
            div.classList.add('item');
            div.innerHTML = `<strong>${user.name}</strong><br>Email: ${user.email}<br>City: ${user.address.city}`;
            container.appendChild(div);
        });
    } catch (error) {
        container.innerHTML = `<p style="color:red">${error.message}</p>`;
    }
}
</script>

<!-- 31 -->
  <h2>31.API Data-Error Handling</h2>
  <button id="fetchBtn">Fetch Data</button>
  <div id="output"></div>

  <script>
    const fetchBtn = document.getElementById("fetchBtn");
    const output = document.getElementById("output");

    fetchBtn.addEventListener("click", async () => {
      output.textContent = "Loading...";
      try {
        const response = await fetch("https://api.example.com/data");

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        output.textContent = JSON.stringify(data, null, 2); // display JSON nicely
      } catch (error) {
        console.error("Error fetching data:", error.message);
        output.textContent = "Failed to fetch data. Please try again later.";
      }
    });
  </script>

<!-- 32 -->
<h2>32.Search Meals</h2>
  <input type="text" id="searchInput" placeholder="Enter meal name">
  <button id="searchBtn">Search</button>

  <div id="results"></div>

  <script>
    const searchBtn = document.getElementById("searchBtn");
    const searchInput = document.getElementById("searchInput");
    const resultsDiv = document.getElementById("results");

    searchBtn.addEventListener("click", async () => {
      const query = searchInput.value.trim();
      if (!query) {
        resultsDiv.innerHTML = "<p class='error'>Please enter a meal name.</p>";
        return;
      }

      resultsDiv.textContent = "Searching...";

      try {
        const response = await fetch(
          `https://www.themealdb.com/api/json/v1/1/search.php?s=${encodeURIComponent(query)}`
        );

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();

        if (!data.meals) {
          resultsDiv.innerHTML = "<p>No meals found.</p>";
          return;
        }

        // Render results
        resultsDiv.innerHTML = "";
        data.meals.forEach(meal => {
          const div = document.createElement("div");
          div.className = "meal";
          div.innerHTML = `
            <h3>${meal.strMeal}</h3>
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}" width="150">
            <p>${meal.strArea} cuisine</p>
          `;
          resultsDiv.appendChild(div);
        });
      } catch (error) {
        console.error("Error fetching meals:", error.message);
        resultsDiv.innerHTML = "<p class='error'>Search failed. Try again later.</p>";
      }
    });
  </script>

<!-- 33 -->
  <h2>33.User List</h2>
  <button onclick="fetchUserData()">Load Users</button>

  <div id="result"></div>

  <script>
    async function fetchUserData() {
      const result = document.getElementById("result");
      result.textContent = "Loading...";

      try {
        const apiResponse = await fetch("https://jsonplaceholder.typicode.com/users");

        if (!apiResponse.ok) {
          throw new Error("API request failed");
        }

        const userList = await apiResponse.json();

        let tableHTML = `
          <table>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Email</th>
              <th>City</th>
            </tr>
        `;

        userList.forEach(person => {
          tableHTML += `
            <tr>
              <td>${person.id}</td>
              <td>${person.name}</td>
              <td>${person.email}</td>
              <td>${person.address.city}</td>
            </tr>
          `;
        });

        tableHTML += "</table>";
        result.innerHTML = tableHTML;

      } catch (err) {
        console.error(err);
        result.innerHTML = "<p class='error'>Failed to load user data.</p>";
      }
    }
  </script>

<!-- 34 -->
  <h2>34.Select Country</h2>

  <select id="countrySelect">
    <option>Loading countries...</option>
  </select>

  <script>
    const countrySelect = document.getElementById("countrySelect");

    async function loadCountries() {
      try {
        const response = await fetch(
          "https://restcountries.com/v3.1/all?fields=name,cca2"
        );

        if (!response.ok) {
          throw new Error("API error");
        }

        const countryList = await response.json();

        countrySelect.innerHTML = '<option value="">Select a country</option>';

        countryList
          .sort((a, b) =>
            a.name.common.localeCompare(b.name.common)
          )
          .forEach(item => {
            const option = document.createElement("option");
            option.value = item.cca2;
            option.textContent = item.name.common;
            countrySelect.appendChild(option);
          });

      } catch (error) {
        console.error(error);
        countrySelect.innerHTML =
          "<option>Unable to load countries</option>";
      }
    }

    loadCountries();
  </script>

<!-- 35 -->

  <h2>35.Loading spinner</h2>
    <!-- <h2>Post List</h2> -->
  <button onclick="getPostData()">Load Data</button>

  <div id="loadingBox" class="loader"></div>
  <div id="dataBox"></div>

  <script>
    async function getPostData() {
      const loadingBox = document.getElementById("loadingBox");
      const dataBox = document.getElementById("dataBox");

      // show loader
      loadingBox.style.display = "block";
      dataBox.innerHTML = "";

      try {
        const apiResult = await fetch("https://jsonplaceholder.typicode.com/posts");

        if (!apiResult.ok) {
          throw new Error("API Error");
        }

        const postList = await apiResult.json();

        postList.slice(0, 5).forEach(postItem => {
          const div = document.createElement("div");
          div.className = "card";
          div.innerHTML = `<b>${postItem.title}</b><br>${postItem.body}`;
          dataBox.appendChild(div);
        });

      } catch (err) {
        console.error(err);
        dataBox.innerHTML = "Unable to load data.";
      } finally {
        // hide loader
        loadingBox.style.display = "none";
      }
    }
  </script>

</body>
</html>
